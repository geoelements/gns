name: GNS Train and Test

on:
  push:
  pull_request:

jobs:
  gns:
    runs-on: ubuntu-latest
    container:
      image: ghcr.io/geoelements/gns:v2

    steps:
    - name: Checkout repository
      uses: actions/checkout@v4
    
    - name: Black linter
      run: |
        black --check .

    - name: PyTest
      run: |
        pytest test/
        
    - name: Train GNS
      run: |
        TMP_DIR="../gns-sample"
        DATASET_NAME="WaterDropSample"
        git clone https://github.com/geoelements/gns-sample ../gns-sample
        python -m gns.train mode="train" training.steps=10
